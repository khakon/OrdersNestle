<!--
  Generated template for the OrdersPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar no-border-bottom>
    <ion-title>
      Документы
    </ion-title>
  </ion-navbar>

  <ion-toolbar no-border-top>
    <ion-segment [(ngModel)]="doc">
      <ion-segment-button value="pivot">
        Общий
      </ion-segment-button>
      <ion-segment-button value="orders">
        Заказы
      </ion-segment-button>
      <ion-segment-button value="invoices">
        Накладные
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div [ngSwitch]="doc"  id="sale-documents">
    <div *ngSwitchCase="'pivot'">
          <dx-data-grid id="gridContainer"
                        #grid
                        [dataSource]="pivot"
                        (onRowPrepared)="onRowPrepared($event)"
                        (onCellPrepared)="onCellPreparedPivot($event)"
                        (onSelectionChanged) = "onSelectionChangedPivot($event)"
                        (onToolbarPreparing)="onToolbarPreparing($event)">
            <dxo-header-filter [visible]="true"></dxo-header-filter>
            <dxo-search-panel [visible]="true"
                              [width]="240"
                              placeholder="Поиск..."></dxo-search-panel>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column caption="Покупатель" dataField="customer"></dxi-column>
            <dxi-column caption="Дата" dataField="dateOrder" dataType="date" format='shortDate' width="80"></dxi-column>
            <dxi-column caption="Заказ" dataField="idOrder" width="90"></dxi-column>
            <dxi-column caption="Сумма" dataField="sumOrder" width="80"></dxi-column>
            <dxi-column caption="Дата" dataField="dateInvoice" dataType="date" format='shortDate' width="80"></dxi-column>
            <dxi-column caption="Накл" dataField="idInvoice" width="90"></dxi-column>
            <dxi-column caption="Сумма" dataField="sumInvoice" width="80"></dxi-column>
            <dxo-summary>
              <dxi-total-item column="sum" summaryType="sum" [customizeText]="customizeSum"></dxi-total-item>
            </dxo-summary>
          </dx-data-grid>
    </div>
    <div *ngSwitchCase="'orders'">
          <dx-data-grid id="gridContainer"
                        #grid
                        [dataSource]="orders"
                        (onRowPrepared)="onRowPrepared($event)"
                        (onCellPrepared)="onCellPrepared($event)"
                        (onSelectionChanged) = "onSelectionChangedOrder($event)"
                        (onToolbarPreparing)="onToolbarPreparing($event)">
            <dxo-header-filter [visible]="true"></dxo-header-filter>
            <dxo-search-panel [visible]="true"
                              [width]="240"
                              placeholder="Поиск..."></dxo-search-panel>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column caption="Дата" dataField="docDate" dataType="date" format='shortDate' width="80"></dxi-column>
            <dxi-column caption="Номер" dataField="idDoc" width="90"></dxi-column>
            <dxi-column caption="Покупатель" dataField="customer"></dxi-column>
            <dxi-column caption="Сумма" dataField="sum" width="80"></dxi-column>
            <dxo-summary>
              <dxi-total-item column="sum" summaryType="sum" [customizeText]="customizeSum"></dxi-total-item>
            </dxo-summary>
          </dx-data-grid>
    </div>
    <div *ngSwitchCase="'invoices'">
          <dx-data-grid id="gridContainer"
                        [dataSource]="invoices"
                        (onRowPrepared)="onRowPrepared($event)"
                        (onCellPrepared)="onCellPrepared($event)"
                        (onSelectionChanged) = "onSelectionChangedInvoice($event)"
                        (onToolbarPreparing)="onToolbarPreparing($event)">
            <dxo-header-filter [visible]="true"></dxo-header-filter>
            <dxo-search-panel [visible]="true"
                              [width]="240"
                              placeholder="Поиск..."></dxo-search-panel>
            <dxo-selection mode="single"></dxo-selection>
            <dxi-column caption="Дата" dataField="docDate" dataType="date" format='shortDate' width="80"></dxi-column>
            <dxi-column caption="Номер" dataField="idDoc" width="90"></dxi-column>
            <dxi-column caption="Покупатель" dataField="customer"></dxi-column>
            <dxi-column caption="Сумма" dataField="sum" width="80"></dxi-column>
            <dxo-summary>
              <dxi-total-item column="sum" summaryType="sum" [customizeText]="customizeSum"></dxi-total-item>
            </dxo-summary>
          </dx-data-grid>
    </div>
  </div>
</ion-content>
